# 编程题
![](第九章_编程题_images/编程题_1.png)
![](第九章_编程题_images/编程题_2.png)
![](第九章_编程题_images/编程题_3-1.png)
![](第九章_编程题_images/编程题_3-2.png)
![](第九章_编程题_images/编程题_4.png)


## 1.
头文件`golf.h`:
```cpp
const int Len = 40;
struct golf
{
    char fullname[Len];
    int handicap;
};

void setgolf(golf & g, const char * name, int hc);

int setgolf(golf & g);

void handicap(golf & g, int hc);

void showgolf(const golf &g);
```
cpp文件`golf.cpp`:
```cpp
#include <iostream>
#include <cstring>
#include "golf.h"

using namespace std;

void setgolf(golf &g, const char *name, int hc)
{
    strcpy(g.fullname, name);   // 字符串拷贝
    g.handicap = hc;
}

int setgolf(golf &g)
{
    int temp = 1;       // true
    cout << "The fullname is: ";
    cin.getline(g.fullname, Len);       // 捕获一整行

    // 比较字符串, 看看输入是否成功
    if(strcmp(g.fullname, "") == 0){
        cout << "invalid input! Ending this gold player info..." << endl;
        temp = 0;       // false
        return temp;
    }
    else{
        cout << "The handicap is: ";
        cin >> g.handicap;
        cin.get();              // 清除缓冲区里的回车
        return temp;
    }
}

void handicap(golf &g, int hc)
{
    g.handicap = hc;
}

void showgolf(const golf &g)
{
    cout << "The fullname is: " << g.fullname << endl;
    cout << "The Handicap is: " << g.handicap << endl;
}

```

main文件`main.cpp`:
```cpp
#include <iostream>
#include "golf.h"

using namespace std;

const int SIZE = 3;

int main(void)
{
    golf g[SIZE];      // 2个数组
    int count = 0;     // 统计输入的次数

    cout << "Please enter the infomation of golf players: " << endl;

    while( count < SIZE && setgolf(g[count]) ){
        cout << "Please enter next player: " << endl;
        count ++;
    }

    cout << "\nShowing all golg infomations..." << endl;

    for(int i = 0; i < count; i++){
        showgolf(g[i]);
    }

    cout << "Reset all the player's information..." << endl;

    for (int i  = 0; i < count; i++){
        handicap(g[i], 90);
        showgolf(g[i]);
    }
    return 0;
}
```

## 2.
```cpp
/*
    局部静态变量 -- 代码块中使用static
*/

#include <iostream>
#include <string>
using namespace std;

void strCount(const string str);

int main(void)
{
    string input;
    char next;

    cout << "Enter a line (less than 9 chars):" << endl;

    getline(cin,input);
    while(input != ""){                 // 判断是否真的有输入
        // 捕获单个字符, 用来检测是不是因为输入回车才结束输入 (cin.get()遇到回车时, 不仅会结束输入, 还会把回车存放在缓冲区)
        cin.get(next);
        strCount(input);        // 统计一共捕获了多少个字符
        cout << "Enter next line (empty line to quit)" << endl;
        getline(cin, input);
    }
    cout << "Bye!" << endl;     // 此时输入的是空行.

    return 0;
}

void strCount(const string str)
{
    static int total = 0;       // 局部静态变量(只会初始化一次, 多次调用strCount也不会反复初始化)
    int count = 0;              // 局部变量(每次都会初始化)

    count = str.size();
    total += count;             // 统计整个程序一共输入了多少个字符

    cout << count << " characters" << endl;
    cout << total << " characters in total." << endl;
    cout << "----------- \n"; 
}
```

## 3.
```cpp
#include <iostream>
#include <cstring>      // 使用strcpy函数
#include <new>

using namespace std;

struct chaff
{
    char dross[20];
    int slag;
};

void show(const chaff &p);

const int BUF = 512;
char buffer[BUF];       // 为了使用placement new

int main(void)
{
    // method 1: 定位new
    chaff *pd1 = new(buffer) chaff[2];      // 一个结构体类型指针, 指向一个结构体数组, 数组有两个元素

    // method 2: 常规new
    chaff *pd2 = new chaff[2];

    char dross[20] = "";
    int slag = 0;

    // 赋值
    for(int i = 0; i < 2; i++){
        cout << "#" << i+1 << ": " << endl;
        cout << "Enter the dross: ";
        cin.getline(dross, 20);
        cout << "Enter the slag: ";
        cin >> slag;
        cin.get();      // 消耗掉缓冲区的回车

        strcpy(pd1[i].dross, dross);
        strcpy(pd2[i].dross, dross);
        pd1[i].slag = slag;
        pd2[i].slag = slag;
    }

    cout << "\n";
    for(int i = 0; i < 2; i++){
        show(pd1[i]);
        show(pd2[i]);
        cout << "-------" << endl;
    }

    delete[] pd2;       // 注意 pd1 是静态空间, 不能delete
    return 0;
}

void show(const chaff &p)
{
    cout << "The dross is: " << p.dross << endl;
    cout << "The slag is: " << p.slag << endl;
}
```

## 4.
头文件`p4.h`
```cpp
#ifndef __P4_H__
#define __P4_H__

#include <iostream>

namespace SALES
{
    const int QUARTERS = 4;
    struct Sales
    {
        double sales[QUARTERS];
        double average;
        double max;
        double min;
    };

    void setSales(Sales &s, const double arr[], int n);      // n >= 4时, 只输入4个; n < 4时, 没输入的补零
    void setSales(Sales &s);
    void showSales(const Sales &s);

}

#endif // __P4_H__
```

cpp文件`p4.cpp`
```cpp
#include "p4.h"

using namespace std;

namespace SALES
{
    /// @brief 非交互式填充结构体内容
    /// @param s 
    /// @param arr 
    /// @param n 
    void setSales(Sales &s, const double arr[], int n)     // n >= 4时, 只输入4个; n < 4时, 没输入的补零
    {
        double total = 0.0;
        int i = 0;

        // 赋值 & 算平均值
        for(i = 0; i < n && i < 4; i++){                   // 多于4个也还是输入4个
            s.sales[i] = arr[i];
            total += s.sales[i];
        }
        s.average = total / i;

        // 计算最大最小值
        s.max = s.sales[0];
        s.min = s.sales[0];
        for (int k = 1; k < i; k++){
            s.max = (s.max > s.sales[k]) ? s.max : s.sales[k];
            s.min = (s.min < s.sales[k]) ? s.min : s.sales[k];
        }

        // 异常处理
        if(n < 4){      // 输入的n不足4个, 则需要补零, 补足4个
            for(int k = n; k < 4; k++){
                s.sales[k] = 0;
            }
        }
    }

    /// @brief 交互式的方式填充结构体内容
    /// @param s 
    void setSales(Sales &s)
    {
        double total = 0.0;
        int i = 0;

        cout << "Enter 4 sales quarters:  " << endl;
        for (i = 0; i < QUARTERS; i++){     // 常量的声明放在头文件中.
            cout << "#" << i+1 << ": " << endl;
            cin >> s.sales[i];
            total += s.sales[i];

            if (i == 0){
                s.max = s.sales[i];
                s.min = s.sales[i];
            }
            else{
                s.max = (s.max > s.sales[i]) ? s.max : s.sales[i];
                s.min = (s.min < s.sales[i]) ? s.min : s.sales[i];
            }
        }
        s.average = total / QUARTERS;
    }

    void showSales(const Sales &s)
    {
        cout << "Sales of 4 QUARTERS: " << endl;
        for(int i = 0; i < QUARTERS; i++){
            cout << s.sales[i] << endl;
        }
        cout << "Average: " << s.average << endl;
        cout << "Max: " << s.max << endl;
        cout << "Min: " << s.min << endl;
    }
}
```

主函数文件`main.cpp`
```cpp
#include "p4.h"
using namespace std;
using namespace SALES;

int main(void)
{
    double arr[4] = {11.1, 22.2, 33.3, 44.4};
    Sales sl;
    setSales(sl, arr, 4);
    showSales(sl);

    setSales(sl);       // 交互式函数, 重载函数
    showSales(sl);
    return 0;
}
```
